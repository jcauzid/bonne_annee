<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bonne Année — Split-Flap</title>
  <style>
    html, body { height:100%; margin:0; background:#0b0b0b; color:#fff; }
    body { display:flex; align-items:center; justify-content:center; }
    .wrap { width:min(1100px, 92vw); }
    h1{
      margin:0 0 14px 0;
      text-align:center;
      font: 800 42px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing:.04em;
    }
    canvas { width:100%; height:auto; display:block; background:#0b0b0b; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>BONNE ANNÉE</h1>
    <canvas id="board"></canvas>
  </div>

<script>
(() => {
  // ============================
  // LISTES DE MOTS (1 par ligne) + tirage au sort
  // ============================
  const WORDS_LINE1 = ["GARE", "TRAIN", "DEPART", "ARRIVEE", "RETARD"];
  const WORDS_LINE2 = ["PARIS", "NANCY", "METZ", "LYON", "STRASB"];

  function randomChoice(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
  const LINE1 = randomChoice(WORDS_LINE1);
  const LINE2 = randomChoice(WORDS_LINE2);

  // Alphabet “roue”
  const ALPHABET = " ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-./";

  // ============================
  // VITESSE (plus petit = plus rapide)
  // ============================
  const FLIP_FRAMES = 6;
  const FRAME_MS    = 14;
  const STEP_MS     = 25;

  // ============================
  // DIMENSIONS
  // ============================
  const CELL_W = 72, CELL_H = 92;
  const GAP_X = 8, GAP_Y = 16;
  const PAD = 18;

  // Couleurs / typo
  const BG = "#0b0b0b", CELL_BG = "#111111";
  const SHADOW = "rgba(0,0,0,.55)";
  const DIVIDER = "#2a2a2a", TEXT = "#ffffff", EDGE = "#1c1c1c";
  const FONT_FAMILY = "ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace";
  const FONT_SIZE = 52;

  // ============================
  // AUDIO (clic) — activé au 1er clic
  // ============================
  let audioCtx = null, audioEnabled = false;
  function ensureAudio() {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (audioCtx.state === "suspended") audioCtx.resume();
    audioEnabled = true;
  }
  function clickSound() {
    if (!audioEnabled || !audioCtx) return;
    const t = audioCtx.currentTime;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = "square";
    osc.frequency.setValueAtTime(1800, t);
    gain.gain.setValueAtTime(0.0001, t)
